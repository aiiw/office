UPDATE T
SET empid = '21592',CardNumber='47648',CreatorCode='123369'
FROM T_HR_PunchRecord T
WHERE T.ID NOT IN (
(SELECT id
FROM (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY CAST(time AS DATE) ORDER BY time ASC) as EarlyRank,
        ROW_NUMBER() OVER (PARTITION BY CAST(time AS DATE) ORDER BY time DESC) as LateRank
    FROM T_HR_PunchRecord
    WHERE empid = 3584 and Time>'2023-11-21 00:00:00.000'
) sub
WHERE sub.EarlyRank <= 1 OR sub.LateRank <= 1))

and   T.empid = 3584 and T.Time>'2023-11-21 00:00:00.000'