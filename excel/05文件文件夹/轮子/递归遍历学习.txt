'文件夹递归大概流程:
'1.打开文件夹,输出当前文件夹名,然后输出所有文件夹下的文件名
'2.判断此文件夹是否有子文件夹,如果有子文件夹,则转到1
'就这么两部流程 , 从2转到1, 则为递归
Dim FSO As Object, arr(1 To 10 ^ 7, 1 To 1), i
'主程序
Sub test1()
    Set FSO = CreateObject("scripting.filesystemobject")
    test2 "C:\Users\Administrator\Desktop\选择多个文件夹"
    Cells.Clear
    If i Then [a1].Resize(i, 1) = arr
End Sub
'
Sub test2(MyPath As String)
    Dim Folder As Object, SubFolder As Object
    Dim FileCollection As Object, FileName As Object
    Set Folder = FSO.getfolder(MyPath)
    Set FileCollection = Folder.Files
    For Each FileName In FileCollection
        i = i + 1: arr(i, 1) = FileName
    Next
    For Each SubFolder In Folder.SubFolders
        test2 SubFolder.Path
    Next
End Sub

