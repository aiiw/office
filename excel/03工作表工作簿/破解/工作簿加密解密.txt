
Sub 设置打开密码()
ActiveWorkbook.Password = "123"
End Sub

Set wk = Workbooks.Open(Filename:="成绩.xls", Password:=123456)
ThisWorkbook.Sheets(1).[A1] = wk.Sheets(1).Range("A1").Value


'解锁工作簿密码（已知密码）
Const pw As String = "123"
Sub LoopFiles()
Dim MyFileName, MyPath As String
Dim MyBook As Workbook
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
MyFileName = Dir(ThisWorkbook.Path & "\工作簿1.xlsx")
Do Until MyFileName = ""
    Workbooks.Open MyPath & MyFileName, Password:=pw, WriteRespassword:=pw
    Set MyBook = ActiveWorkbook
    MyBook.Password = ""                '撤销打开密码
    MyBook.WritePassword = ""           '撤销写密码
    MyBook.Close True
    MyFileName = Dir
Loop
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
End Sub


