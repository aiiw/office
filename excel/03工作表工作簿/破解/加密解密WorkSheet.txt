'保护工作表：
'ActiveSheet.Protect Password:="123"
'撤销保护：
'ActiveSheet.Unprotect ("123")
'ActiveSheet：当前工作簿，活动工作表。

Sub Remove_WorkSheet_Password()
 Dim i As Integer, j As Integer, k As Integer
 Dim l As Integer, m As Integer, n As Integer
 Dim i1 As Integer, i2 As Integer, i3 As Integer
 Dim i4 As Integer, i5 As Integer, i6 As Integer
 On Error Resume Next
 If ActiveSheet.ProtectContents = False Then
 MsgBox "该工作表没有保护密码！"
 Exit Sub
 End If
 For i = 65 To 66: For j = 65 To 66: For k = 65 To 66
 For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66
 For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66
 For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126
ActiveSheet.Unprotect Chr(i) & Chr(j) & Chr(k) & _
 Chr(l) & Chr(m) & Chr(i1) & Chr(i2) & Chr(i3) & _
 Chr(i4) & Chr(i5) & Chr(i6) & Chr(n)
 If ActiveSheet.ProtectContents = False Then
 MsgBox "已经解除了工作表保护！"
 Exit Sub
 End If
 Next: Next: Next: Next: Next: Next
 Next: Next: Next: Next: Next: Next
End Sub


Sub 删除密码() '利用Excel的BUG实现清除密码
'对工作表加密，记住其中Protect的参数变化
  ActiveSheet.Protect DrawingObjects:=True, Contents:=True, AllowFiltering:=True
  ActiveSheet.Protect DrawingObjects:=False, Contents:=True, AllowFiltering:=True
  ActiveSheet.Protect DrawingObjects:=True, Contents:=True, AllowFiltering:=True
  ActiveSheet.Protect DrawingObjects:=False, Contents:=True, AllowFiltering:=True
  ActiveSheet.Unprotect '解密
End Sub


