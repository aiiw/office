Private Declare Function GetCursorPos Lib "user32" (lpPoint As POINTAPI) As Long
Private Declare Function WindowFromPoint Lib "user32" (ByVal xPoint As Long, ByVal yPoint As Long) As Long
Public Type POINTAPI
X As Long
Y As Long
End Type
Sub xyf()
    Dim i As POINTAPI
    GetCursorPos i
    Debug.Print i.X, i.Y
    Dim lHwnd As Long
    lHwnd = WindowFromPoint(i.X, i.Y)
    MsgBox lHwnd
End Sub